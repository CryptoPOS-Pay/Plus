
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Paiement avec CryptoPOS</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <img src="logo.png" alt="CryptoPOS" class="logo" />
    <h1>Paiement avec CryptoPOS</h1>

    <label for="amount">Montant</label>
    <input type="number" id="amount" placeholder="0.01" />

    <div id="fiat"></div>

    <label for="crypto">Crypto</label>
    <div class="crypto-select">
      <select id="crypto">
        <option value="ETH">Ethereum</option>
        <option value="MATIC">Polygon</option>
      </select>
      <img id="crypto-logo" src="eth.png" alt="Logo Crypto" />
    </div>

    <label for="merchant">Adresse du commer√ßant</label>
    <input type="text" id="merchant" value="0xee328ed15e857A539Ebccae130de04bE47cea897" />

    <button onclick="pay()">Envoyer</button>

    <div id="status"></div>

    <div class="wallet-info">
      <img src="metamask.png" alt="MetaMask" class="metamask-icon" />
      <p>Connectez votre portefeuille pour proc√©der au paiement</p>
      <p>Navigateur recommand√© :</p>
      <div class="browsers">
        <img src="firefox.png" alt="Firefox" />
        <img src="chrome.png" alt="Chrome" />
        <img src="edge.png" alt="Edge" />
      </div>
    </div>

    <p class="secure">Paiement 100 % s√©curis√© via la blockchain üîí</p>
  </div>

  <script>
    const fiatDisplay = document.getElementById("fiat");
    const cryptoSelect = document.getElementById("crypto");
    const logo = document.getElementById("crypto-logo");

    cryptoSelect.addEventListener("change", () => {
      const selected = cryptoSelect.value;
      logo.src = selected === "MATIC" ? "matic.png" : "eth.png";
    });

    async function pay() {
      if (!window.ethereum) {
        alert("Veuillez installer MetaMask.");
        return;
      }
      const provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      const signer = provider.getSigner();

      const to = document.getElementById("merchant").value;
      const ethAmount = document.getElementById("amount").value;
      const amountInWei = ethers.utils.parseEther(ethAmount);

      try {
        const tx = await signer.sendTransaction({ to, value: amountInWei });
        document.getElementById("status").innerHTML = `‚úÖ <a href="https://sepolia.etherscan.io/tx/${tx.hash}" target="_blank">Voir la transaction</a>`;
      } catch (err) {
        document.getElementById("status").innerText = "‚ùå Paiement annul√©, veuillez r√©essayer.";
      }
    }
  </script>
</body>
</html>
